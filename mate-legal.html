<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mate de Legal - Aprende Ajedrez</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <nav>
        <ul></ul>
    </nav>

    <div class="container">
        <header class="page-header">
            <h1>Mate de Legal</h1>
            <p>Conoce el concepto del sacrificio de Dama y la secuencia de jugadas.</p>
        </header>

        <div class="content-card">
            <h2>¿Qué es el Mate de Legal?</h2>
            <p>El <strong>Mate de Legal</strong> es una trampa famosa que demuestra el poder de un sacrificio táctico. En este mate, las blancas sacrifican su dama para exponer un jaque mate ineludible.</p>
            <p>Esta combinación es un excelente ejemplo de cómo el desarrollo de piezas y la coordinación pueden superar el material.</p>
        </div>

        <div class="content-card">
            <h2>Secuencia del Mate de Legal</h2>
            <p><strong>Posición inicial:</strong> Apertura típica donde las negras capturan un peón con su caballo.</p>
            <p><strong>Secuencia clave:</strong></p>
            <ol style="padding-left: 2rem; line-height: 2;">
                <li>e4 e5</li>
                <li>Cf3 d6</li>
                <li>Ac4 Ag4</li>
                <li>Cc3 h6</li>
                <li>Cxe5 Ag5??</li>
                <li>Cxf7! Dxf7</li>
                <li>Axg5 y las negras están perdidas</li>
            </ol>
            <p><strong>El sacrificio:</strong> Las blancas sacrifican el caballo en f7, y si las negras capturan con la dama, la dama queda expuesta y las blancas pueden continuar con ventaja.</p>
            <div class="chessboard-container">
                <div id="chessboard-legal"></div>
            </div>
            <div class="board-controls">
                <button class="btn btn-primary" onclick="playLegalMate()">Reproducir Secuencia</button>
                <button class="btn btn-secondary" onclick="boardLegal.reset()">Reiniciar</button>
            </div>
        </div>

        <div class="content-card">
            <h2>Lecciones del Mate de Legal</h2>
            <ul style="padding-left: 2rem; line-height: 2;">
                <li><strong>Desarrollo temprano:</strong> Las piezas desarrolladas son más valiosas que el material en las primeras etapas</li>
                <li><strong>Coordinación:</strong> Las piezas trabajando juntas pueden crear amenazas mortales</li>
                <li><strong>Sacrificio táctico:</strong> A veces sacrificar material puede conducir a una ventaja decisiva</li>
                <li><strong>No captures prematuramente:</strong> Capturar sin considerar las consecuencias puede ser peligroso</li>
            </ul>
        </div>

        <div class="exercise-panel">
            <h3>Ejercicio: Reproducir el Mate de Legal</h3>
            <div class="exercise-objective">
                <strong>Objetivo:</strong> Reproduce las primeras jugadas clave del Mate de Legal.
            </div>
            <div class="chessboard-container">
                <div id="chessboard-exercise"></div>
            </div>
            <div class="board-controls">
                <button class="btn btn-secondary" onclick="boardExercise.reset()">Reiniciar Ejercicio</button>
            </div>
            <div id="exercise-feedback" class="exercise-feedback"></div>
        </div>
    </div>

    <script src="js/navigation.js"></script>
    <script src="js/chess-engine.js"></script>
    <script src="js/chessboard.js"></script>
    <script>
        const engineLegal = new ChessEngine();
        const boardLegal = new ChessBoard('chessboard-legal', engineLegal);
        boardLegal.render();

        function playLegalMate() {
            boardLegal.reset();
            setTimeout(() => {
                engineLegal.makeMove(6, 4, 4, 4); // e4
                engineLegal.makeMove(1, 4, 3, 4); // e5
                boardLegal.render();
                setTimeout(() => {
                    engineLegal.makeMove(7, 6, 5, 5); // Cf3
                    engineLegal.makeMove(1, 3, 2, 3); // d6
                    boardLegal.render();
                    setTimeout(() => {
                        engineLegal.makeMove(7, 5, 4, 2); // Ac4
                        engineLegal.makeMove(0, 5, 4, 6); // Ag4
                        boardLegal.render();
                    }, 1000);
                }, 1000);
            }, 500);
        }

        const engineExercise = new ChessEngine();
        const boardExercise = new ChessBoard('chessboard-exercise', engineExercise);
        boardExercise.render();
        
        let expectedMoves = ['e2e4', 'g1f3', 'f1c4'];
        let moveIndex = 0;
        
        boardExercise.onMoveCallback = () => {
            const lastMove = engineExercise.moveHistory[engineExercise.moveHistory.length - 1];
            if (!lastMove) return;
            
            const feedback = document.getElementById('exercise-feedback');
            const move = lastMove.notation.substring(0, 4);
            
            if (feedback) {
                feedback.classList.add('show');
                
                if (moveIndex < expectedMoves.length && move === expectedMoves[moveIndex]) {
                    moveIndex++;
                    if (moveIndex < expectedMoves.length) {
                        feedback.classList.add('info');
                        feedback.classList.remove('error', 'success');
                        feedback.textContent = `¡Correcto! Ahora ejecuta: ${expectedMoves[moveIndex]}`;
                    } else {
                        feedback.classList.add('success');
                        feedback.classList.remove('error', 'info');
                        feedback.textContent = '¡Bien! Has comenzado la secuencia del Mate de Legal correctamente.';
                    }
                } else {
                    feedback.classList.add('error');
                    feedback.classList.remove('success', 'info');
                    feedback.textContent = 'Movimiento incorrecto. Intenta seguir la secuencia inicial del Mate de Legal.';
                }
            }
        };
    </script>
    <script>
        (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="oMWT4vhEPAcD7wO6AZRBe";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
    </script>
</body>
</html>

